# Git Smart HTTP Server via fcgiwrap
server {
    listen 80 default_server;
    server_name localhost;

    # This is where your repositories live
    root /var/www/git;
    autoindex on;

    # Default location for non-Git requests
    location / {
        try_files $uri $uri/ =404;
    }

    # Location block for Git smart HTTP requests
    location ~ (/.*\.git)(/.*)?$ {
        fastcgi_pass unix:/var/run/fcgiwrap/fcgiwrap.socket;
        fastcgi_param SCRIPT_FILENAME /usr/lib/git-core/git-http-backend;  # Note the path change for Debian
        fastcgi_param GIT_PROJECT_ROOT /var/www/git;
        fastcgi_param GIT_HTTP_EXPORT_ALL "";
        fastcgi_param REMOTE_USER $remote_user;
        fastcgi_param PATH_INFO $2;
        include fastcgi_params;
    }
}